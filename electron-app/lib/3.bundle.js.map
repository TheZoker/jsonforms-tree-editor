{"version":3,"sources":["webpack:///../node_modules/@theia/variable-resolver/src/browser/variable-quick-open-service.ts","webpack:///../node_modules/@theia/variable-resolver/src/browser/variable-resolver-service.ts","webpack:///../node_modules/@theia/variable-resolver/src/browser/variable.ts"],"names":[],"mappings":"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","file":"3.bundle.js","sourcesContent":["/********************************************************************************\n * Copyright (C) 2018 Red Hat, Inc. and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { QuickOpenService, QuickOpenModel, QuickOpenItem, QuickOpenMode } from '@theia/core/lib/browser/quick-open/';\nimport { VariableRegistry } from './variable';\n\n@injectable()\nexport class VariableQuickOpenService implements QuickOpenModel {\n\n    protected items: QuickOpenItem[];\n\n    constructor(\n        @inject(VariableRegistry) protected readonly variableRegistry: VariableRegistry,\n        @inject(QuickOpenService) protected readonly quickOpenService: QuickOpenService\n    ) { }\n\n    open(): void {\n        this.items = this.variableRegistry.getVariables().map(\n            v => new VariableQuickOpenItem(v.name, v.description)\n        );\n\n        this.quickOpenService.open(this, {\n            placeholder: 'Registered variables',\n            fuzzyMatchLabel: true,\n            fuzzyMatchDescription: true,\n            fuzzySort: true\n        });\n    }\n\n    onType(lookFor: string, acceptor: (items: QuickOpenItem[]) => void): void {\n        acceptor(this.items);\n    }\n}\n\nexport class VariableQuickOpenItem extends QuickOpenItem {\n\n    constructor(\n        protected readonly name: string,\n        protected readonly description?: string\n    ) {\n        super();\n    }\n\n    getLabel(): string {\n        return '${' + this.name + '}';\n    }\n\n    getDetail(): string {\n        return this.description || '';\n    }\n\n    run(mode: QuickOpenMode): boolean {\n        return false;\n    }\n}\n","/********************************************************************************\n * Copyright (C) 2018 Red Hat, Inc. and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n// tslint:disable:no-any\n\nimport { injectable, inject } from 'inversify';\nimport { VariableRegistry } from './variable';\n\n/**\n * The variable resolver service should be used to resolve variables in strings.\n */\n@injectable()\nexport class VariableResolverService {\n\n    protected static VAR_REGEXP = /\\$\\{(.*?)\\}/g;\n\n    @inject(VariableRegistry) protected readonly variableRegistry: VariableRegistry;\n\n    /**\n     * Resolve the variables in the given string array.\n     * @returns promise resolved to the provided string array with already resolved variables.\n     * Never reject.\n     */\n    resolveArray(value: string[]): Promise<string[]> {\n        return this.resolve(value);\n    }\n\n    /**\n     * Resolve the variables in the given string.\n     * @returns promise resolved to the provided string with already resolved variables.\n     * Never reject.\n     */\n    async resolve<T>(value: T): Promise<T> {\n        const context = new VariableResolverService.Context(this.variableRegistry);\n        const resolved = await this.doResolve(value, context);\n        return resolved as any;\n    }\n\n    protected async doResolve(value: Object | undefined, context: VariableResolverService.Context): Promise<Object | undefined> {\n        if (value === undefined || value === null) {\n            return value;\n        }\n        if (typeof value === 'string') {\n            return this.doResolveString(value, context);\n        }\n        if (Array.isArray(value)) {\n            return this.doResolveArray(value, context);\n        }\n        if (typeof value === 'object') {\n            return this.doResolveObject(value, context);\n        }\n        return value;\n    }\n\n    protected async doResolveObject(obj: object, context: VariableResolverService.Context): Promise<object> {\n        const result: {\n            [prop: string]: Object | undefined\n        } = {};\n        for (const name of Object.keys(obj)) {\n            const value = (obj as any)[name];\n            const resolved = await this.doResolve(value, context);\n            result[name] = resolved;\n        }\n        return result;\n    }\n\n    protected async doResolveArray(values: Array<Object | undefined>, context: VariableResolverService.Context): Promise<Array<Object | undefined>> {\n        const result: (Object | undefined)[] = [];\n        for (const value of values) {\n            const resolved = await this.doResolve(value, context);\n            result.push(resolved);\n        }\n        return result;\n    }\n\n    protected async doResolveString(value: string, context: VariableResolverService.Context): Promise<string> {\n        await this.resolveVariables(value, context);\n        return value.replace(VariableResolverService.VAR_REGEXP, (match: string, varName: string) => {\n            const varValue = context.get(varName);\n            return varValue !== undefined ? varValue : match;\n        });\n    }\n\n    protected async resolveVariables(value: string, context: VariableResolverService.Context): Promise<void> {\n        let match;\n        while ((match = VariableResolverService.VAR_REGEXP.exec(value)) !== null) {\n            const variableName = match[1];\n            await context.resolve(variableName);\n        }\n    }\n\n}\nexport namespace VariableResolverService {\n    export class Context {\n\n        protected readonly resolved = new Map<string, string | undefined>();\n\n        constructor(\n            protected readonly variableRegistry: VariableRegistry\n        ) { }\n\n        get(name: string): string | undefined {\n            return this.resolved.get(name);\n        }\n\n        async resolve(name: string): Promise<void> {\n            if (this.resolved.has(name)) {\n                return;\n            }\n            try {\n                const variable = this.variableRegistry.getVariable(name);\n                const value = variable && await variable.resolve();\n                this.resolved.set(name, value);\n            } catch (e) {\n                console.error(`Failed to resolved '${name}' variable`, e);\n                this.resolved.set(name, undefined);\n            }\n        }\n\n    }\n}\n","/********************************************************************************\n * Copyright (C) 2018 Red Hat, Inc. and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject } from 'inversify';\nimport { ILogger, Disposable, DisposableCollection, MaybePromise } from '@theia/core';\n\n/**\n * Variable can be used inside of strings using ${variableName} syntax.\n */\nexport interface Variable {\n\n    /**\n     * A unique name of this variable.\n     */\n    readonly name: string;\n\n    /**\n     * A human-readable description of this variable.\n     */\n    readonly description?: string;\n\n    /**\n     * Resolve to a string value of this variable or\n     * `undefined` if variable cannot be resolved.\n     * Never reject.\n     */\n    resolve(): MaybePromise<string | undefined>;\n}\n\nexport const VariableContribution = Symbol('VariableContribution');\n/**\n * The variable contribution should be implemented to register custom variables.\n */\nexport interface VariableContribution {\n    registerVariables(variables: VariableRegistry): void;\n}\n\n/**\n * The variable registry manages variables.\n */\n@injectable()\nexport class VariableRegistry implements Disposable {\n\n    protected readonly variables: Map<string, Variable> = new Map();\n    protected readonly toDispose = new DisposableCollection();\n\n    constructor(\n        @inject(ILogger) protected readonly logger: ILogger\n    ) { }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    /**\n     * Register the given variable.\n     * Do nothing if a variable is already registered for the given variable name.\n     */\n    registerVariable(variable: Variable): Disposable {\n        if (this.variables.has(variable.name)) {\n            this.logger.warn(`A variables with name ${variable.name} is already registered.`);\n            return Disposable.NULL;\n        }\n        this.variables.set(variable.name, variable);\n        const disposable = {\n            dispose: () => this.variables.delete(variable.name)\n        };\n        this.toDispose.push(disposable);\n        return disposable;\n    }\n\n    /**\n     * Return all registered variables.\n     */\n    getVariables(): Variable[] {\n        return [...this.variables.values()];\n    }\n\n    /**\n     * Get a variable for the given name or `undefined` if none.\n     */\n    getVariable(name: string): Variable | undefined {\n        return this.variables.get(name);\n    }\n}\n"],"sourceRoot":""}